---
title: "Assignment A2: Electricity Supply and Demand in PJM"
author: "Saemin Kim"
format:
  pdf:
    toc: true
    number-sections: true
date: "`r Sys.Date()`"
---


```{python}
#| echo: false
import os 
import pandas as pd
from IPython.display import display, Markdown, Image

pd.options.display.float_format = '{:,.2f}'.format

def check_exists(path):
    return path is not None and os.path.exists(path)
```

# Question 1: Market Clearing under Inelastic Demand

## Question 1a: Market Clearing Quantity
148,407.90 MW

With perfectly inelastic demand, the market clearing quantity is determined solely by the intersection of demand with the aggregate supply curve. The resulting quantity reflects the total generation required to satisfy fixed electricity demand regardless of price.

## Question 1b: Supply Curve and Market Clearing Outcome

```{python}
#| echo: false
img_q1b = "figures/Q1b_final.png"
if check_exists(img_q1b):
display(Image(filename=img_q1b))
else:
display(Markdown("**Error:** `figures/Q1b_final.png` not found."))
```
The supply curve illustrates how marginal generation costs increase as higher-cost units are dispatched. The market clearing price is set by the marginal generator needed to meet total demand.

# Question 2: Demand Patterns in PJM

## Question 2a: Hourly Demand Profile
```{python}
#| echo: false
img_q2a = "figures/Q2a_final.png"
if check_exists(img_q2a):
display(Image(filename=img_q2a))
else:
display(Markdown("**Error:** `figures/Q2a_final.png` not found."))
```

Hourly demand varies substantially over time, reflecting daily and seasonal consumption patterns. Peak demand periods place greater stress on the system and typically require the dispatch of higher-cost generators.

# Question 2b: Top 5 Peak Demand Hours

```{python}
#| echo: true
csv_q2b = "data/Q2b_final.csv"
if check_exists(csv_q2b):
df_q2b = pd.read_csv(csv_q2b)
display(df_q2b)
else:
print("Error: data/Q2b_final.csv not found.")
```
The highest demand hours correspond to periods when electricity prices and system costs are likely to be the greatest. These peak events play a crucial role in determining capacity needs and market revenues.

# Question 3: Prices and System Costs

## Question 3a: Prices and Costs by Demand Percentile

```{python}
#| echo: true
csv_q3a = "data/Q3a_final.csv"
if check_exists(csv_q3a):
df_q3a = pd.read_csv(csv_q3a)
display(df_q3a)
else:
print("Error: data/Q3a_final.csv not found.")
```

As demand increases across percentiles, both electricity prices and total system costs rise. This reflects the dispatch of increasingly expensive generation units at higher demand levels.

## Question 3b: Market Outcomes under Alternative Scenarios

```{python}
#| echo: false
img_q3b = "figures/Q3b_final.png"
if check_exists(img_q3b):
display(Image(filename=img_q3b))
else:
display(Markdown("**Error:** `figures/Q3b_final.png` not found."))
```
Higher demand scenarios lead to significantly higher clearing prices and system costs. This highlights the nonlinear cost impacts of extreme demand conditions in electricity markets.

# Question 4: Generator Profits and Losses

```{python}
#| echo: true
csv_q4 = "data/Q4_final.csv"
if check_exists(csv_q4):
df_q4 = pd.read_csv(csv_q4)
display(df_q4)
else:
print("Error: data/Q4_final.csv not found.")
```
Generators with lower marginal costs earn higher profits because they receive the market clearing price while incurring lower production costs. High-cost generators may earn little profit or incur losses depending on the market price.

# Question 5: Price-Sensitive Demand

```{python}
#| echo: false
img_q5 = "figures/Q5_final.png"
if check_exists(img_q5):
display(Image(filename=img_q5))
else:
display(Markdown("**Error:** `figures/Q5_final.png` not found."))
```
When demand becomes price-sensitive, higher prices lead to reduced consumption. This dampens extreme price spikes and lowers the market clearing quantity relative to the inelastic demand case.

```{python}
#| echo: true
csv_q5 = "data/Q5_final.csv"
if check_exists(csv_q5):
df_q5 = pd.read_csv(csv_q5)
display(df_q5)
else:
print("Error: data/Q5_final.csv not found.")
```
Price-responsive demand reduces total system costs and reallocates surplus between consumers and producers. This demonstrates the efficiency benefits of demand-side flexibility in electricity markets.

